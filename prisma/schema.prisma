// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../../generated/prisma"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id                  String               @id @default(cuid())
  name                String
  isAdmin             Boolean              @default(false)
  parkingSpots        ParkingSpot[]
  parkingAppointments ParkingAppointment[]
}

model TrafficArea {
  id             String          @id @default(cuid())
  name           String
  description    String
  congestion     Float           @default(0.0)
  trafficReports TrafficReport[]
}

model TrafficReport {
  id            String      @id @default(cuid())
  area          TrafficArea @relation(fields: [areaId], references: [id])
  areaId        String
  address       String
  description   String
  isApproved    Boolean     @default(false)
  isResolved    Boolean     @default(false)
  isRejected    Boolean     @default(false)
  reportedAt    DateTime    @default(now())
  reporterEmail String
}

model ParkingSpot {
  id                  String               @id @default(cuid())
  ownerId             String
  owner               User                 @relation(fields: [ownerId], references: [id])
  address             String
  longitude           Float
  latitude            Float
  capacity            Int
  ratePerHour         Float
  createdAt           DateTime             @default(now())
  updatedAt           DateTime             @updatedAt
  parkingAppointments ParkingAppointment[]
}

model ParkingAppointment {
  id            String      @id @default(cuid())
  parkingSpot   ParkingSpot @relation(fields: [parkingSpotId], references: [id])
  parkingSpotId String
  user          User        @relation(fields: [userId], references: [id])
  userId        String
  startTime     DateTime
  endTime       DateTime
}

model AdminActionLog {
  id           String   @id @default(cuid())
  adminId      String
  action       String
  actionType   String
  actionTypeId String
  timestamp    DateTime @default(now())
}
